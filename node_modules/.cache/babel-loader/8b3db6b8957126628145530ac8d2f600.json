{"ast":null,"code":"import \"source-map-support/register\";\nimport uuid from \"uuid\";\nimport * as dynamoDbLib from \"./libs/dynamodb-lib\";\nimport { success, failure } from \"./libs/response-lib\";\nexport async function main(event, context, callback) {\n  const data = event.body;\n  const tran = event.body.transaction;\n  const params = {\n    TableName: process.env.tableName,\n    Item: {\n      yearMonth: data.yearMonth,\n      transactionId: uuid.v1(),\n      bank: data.bank,\n      userId: event.requestContext.identity.cognitoIdentityId,\n      transaction: tran,\n      attachments: data.attachments,\n      createdAt: Date.now()\n    }\n  };\n\n  try {\n    await dynamoDbLib.call(\"put\", params);\n    return success(params.Item);\n  } catch (e) {\n    //console.log(e);\n    return failure({\n      status: e\n    });\n  }\n  /*dynamoDb.put(params, (error, data) => {\n  // Set response headers to enable CORS (Cross-Origin Resource Sharing)\n  \tconst headers = {\n  \t\"Access-Control-Allow-Origin\": \"*\",\n  \t\"Access-Control-Allow-Credentials\": true\n  \t};\n  \tif (error) {\n  \tconst response = {\n  \t\tstatusCode: 500,\n  \t\theaders: headers,\n  \t\tbody: JSON.stringify({ status: error })\n  \t\t};\n  \tcallback(null, response);\n  \treturn;\n  \t}\n  \tconst response = {\n  \tstatusCode: 200,\n  \theaders: headers,\n  \tbody: JSON.stringify(params.Item)\n  \t};\n  callback(null, response);\n  });*/\n\n}","map":{"version":3,"sources":["/home/robert/Projects/budget/manual_entry.js"],"names":["uuid","dynamoDbLib","success","failure","main","event","context","callback","data","body","tran","transaction","params","TableName","process","env","tableName","Item","yearMonth","transactionId","v1","bank","userId","requestContext","identity","cognitoIdentityId","attachments","createdAt","Date","now","call","e","status"],"mappings":";AAAA,OAAOA,IAAP,MAAiB,MAAjB;AACA,OAAO,KAAKC,WAAZ,MAA6B,qBAA7B;AACA,SAASC,OAAT,EAAkBC,OAAlB,QAAiC,qBAAjC;AAEA,OAAO,eAAeC,IAAf,CAAoBC,KAApB,EAA2BC,OAA3B,EAAoCC,QAApC,EAA8C;AAEpD,QAAMC,IAAI,GAAGH,KAAK,CAACI,IAAnB;AACA,QAAMC,IAAI,GAAGL,KAAK,CAACI,IAAN,CAAWE,WAAxB;AAEA,QAAMC,MAAM,GAAG;AACdC,IAAAA,SAAS,EAAEC,OAAO,CAACC,GAAR,CAAYC,SADT;AAEdC,IAAAA,IAAI,EAAE;AACLC,MAAAA,SAAS,EAAEV,IAAI,CAACU,SADX;AAELC,MAAAA,aAAa,EAAEnB,IAAI,CAACoB,EAAL,EAFV;AAGLC,MAAAA,IAAI,EAAEb,IAAI,CAACa,IAHN;AAILC,MAAAA,MAAM,EAAEjB,KAAK,CAACkB,cAAN,CAAqBC,QAArB,CAA8BC,iBAJjC;AAKLd,MAAAA,WAAW,EAAED,IALR;AAMLgB,MAAAA,WAAW,EAAElB,IAAI,CAACkB,WANb;AAOLC,MAAAA,SAAS,EAAEC,IAAI,CAACC,GAAL;AAPN;AAFQ,GAAf;;AAaA,MAAI;AACH,UAAM5B,WAAW,CAAC6B,IAAZ,CAAiB,KAAjB,EAAwBlB,MAAxB,CAAN;AACA,WAAOV,OAAO,CAACU,MAAM,CAACK,IAAR,CAAd;AACC,GAHF,CAIA,OAAOc,CAAP,EAAU;AACT;AACA,WAAO5B,OAAO,CAAC;AAAE6B,MAAAA,MAAM,EAAED;AAAV,KAAD,CAAd;AACC;AAEF;;;;;;;;;;;;;;;;;;;;;;;AA0BA","sourcesContent":["import uuid from \"uuid\";\nimport * as dynamoDbLib from \"./libs/dynamodb-lib\";\nimport { success, failure } from \"./libs/response-lib\";\n\nexport async function main(event, context, callback) {\n\n\tconst data = event.body;\n\tconst tran = event.body.transaction;\n\n\tconst params = {\n\t\tTableName: process.env.tableName,\n\t\tItem: {\n\t\t\tyearMonth: data.yearMonth,\n\t\t\ttransactionId: uuid.v1(),\n\t\t\tbank: data.bank,\n\t\t\tuserId: event.requestContext.identity.cognitoIdentityId,\n\t\t\ttransaction: tran,\n\t\t\tattachments: data.attachments,\n\t\t\tcreatedAt: Date.now()\n\t\t\t}\n\t\t};\n\n\ttry {\n\t\tawait dynamoDbLib.call(\"put\", params);\n\t\treturn success(params.Item);\n\t\t}\n\tcatch (e) {\n\t\t//console.log(e);\n\t\treturn failure({ status: e });\n\t\t}\n\n\t/*dynamoDb.put(params, (error, data) => {\n// Set response headers to enable CORS (Cross-Origin Resource Sharing)\n\t\tconst headers = {\n\t\t\"Access-Control-Allow-Origin\": \"*\",\n\t\t\"Access-Control-Allow-Credentials\": true\n\t\t};\n\n\tif (error) {\n\t\tconst response = {\n\t\t\tstatusCode: 500,\n\t\t\theaders: headers,\n\t\t\tbody: JSON.stringify({ status: error })\n\t\t\t};\n\t\tcallback(null, response);\n\t\treturn;\n\t\t}\n\n\tconst response = {\n\t\tstatusCode: 200,\n\t\theaders: headers,\n\t\tbody: JSON.stringify(params.Item)\n\t\t};\n\tcallback(null, response);\n\t});*/\n\n\n}"]},"metadata":{},"sourceType":"module"}